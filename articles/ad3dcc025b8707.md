---
title: "Playwrightを使ってMantineの自動テスト"
emoji: "👌"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["playwright", "mantine", "nextjs", "e2e"]
published: false
---

# はじめに

Mantine便利ですよね。

MantineのE2Eテストを実行するときに、自動テストで記録される項目と各種可能な操作を記録していきます。
画面を見ながら作成できるのが一番ですが、コードを見ながらでもテストを作成できることを想定しています。

https://mantine.dev/getting-started/

上記のページの左タブの`MANTINE CORE`に表示されている内容の取得方法を備忘録的にまとめます。
例外的に`Layout`と`Compobox`は除いています。

# 背景

`data-testid`を付与するのがいいと思っていましたが、playwrightだとあまり推奨していないみたいです。
そのため、実際に自動テストで記録される項目を記録していきます。
文字サイズ・ボールド・divやpaddingなども合わせて確認できたらいいな。

# 実行環境

- macOS: 14.1
- Next.js: 14.0
- Node.js: 20.1
- Mantine: 7.2.2
- Playwright: 7.2.2

## 準備

以下のコマンドで`Playwright`をインストールします。

```shell
$ npm init playwright@latest

Initializing project in '.'
✔ Where to put your end-to-end tests? · tests
✔ Add a GitHub Actions workflow? (y/N) · true
✔ Install Playwright browsers (can be done manually via 'npx playwright install')? (Y/n) · true
Installing Playwright Test (npm install --save-dev @playwright/test)…
```


# テスト項目

それぞれのコンポーネントごとにテストコードを列挙していきます。

::: message
ハイドレーションなどをきちんと考慮したコードにはなっていないです。
:::

## `Inputs`

### Checkbox

```typescript: test/mantine-input.tsx
<Checkbox
  defaultChecked
  label="I agree to sell my privacy"
/>
```

```typescript
await page.getByLabel('I agree to sell my privacy').check();
await page.getByText('I agree to sell my privacy').click();
```

ロールは取れない？

### Chip

```typescript: test/mantine-input.tsx
<Chip defaultChecked>Awesome chip</Chip>
```

```typescript
await page.getByText('Awesome chip').click();
```

### Input(JsonInput)

```typescript: test/mantine-input.tsx
<JsonInput
  label="Your package.json"
  placeholder="Textarea will autosize to fit the content"
  validationError="Invalid JSON"
  formatOnBlur
  autosize
  minRows={4}
/>
```

```typescript
// 選択した場合
await page.getByPlaceholder('Textarea will autosize to fit').click();
// 文字を入力した場合
await page.getByPlaceholder('Textarea will autosize to fit').fill('hello');
```

### Input(NativeSelect)

```typescript: test/mantine-input.tsx
<NativeSelect 
  label="Input label" 
  description="Input description" 
  data={['React', 'Angular', 'Vue']} 
/>
```

```typescript
// 各要素を選択した場合
await page.getByLabel('Input label').selectOption('React');
await page.getByLabel('Input label').selectOption('Angular');
await page.getByLabel('Input label').selectOption('Vue');
```


### Input(NumberInput)

```typescript: test/mantine-input.tsx
<NumberInput
  label="NumberInput label"
  description="Input description"
  placeholder="Input placeholder"
/>
```

```typescript
// 要素を押下したとき
await page.getByLabel('NumberInput label').click();
await page.getByRole('textbox', { name: 'NumberInput label', exact: true }).click();
// 要素に値を入力したとき
await page.getByLabel('NumberInput label').fill('111');
await page.getByRole('textbox', { name: 'NumberInput label', exact: true }).fill('111');
// 要素の右端の上ボタンを押下したとき
await page.locator('button').first().click();
// 要素の右端の下ボタンを押下したとき
await page.locator('button').nth(1).click();
```

### Input(PasswordInput)

```typescript: test/mantine-input.tsx
<PasswordInput
  label="PasswordInput label"
  description="Input description"
  placeholder="Input placeholder"
/>
```

```typescript
// 要素を押下したとき
await page.getByLabel('PasswordInput label').click();
// 要素に値を入力したとき
await page.getByLabel('PasswordInput label').fill('hello');
// 要素の右端のパスワード表示・非表示ボタンを押下したとき
await page.locator('div').filter({ hasText: /^PasswordInput labelInput description$/ }).locator('button').click();
```
### PinInput

```typescript: test/mantine-input.tsx
<PinInput />
```

```typescript
//
```
### Radio

```typescript: test/mantine-input.tsx
<Radio
  label="I cannot be unchecked"
/>
```

```typescript
//
```
### Rating

```typescript: test/mantine-input.tsx
<Rating defaultValue={2} />
```

```typescript
//
```

### SegmentedControl

```typescript: test/mantine-input.tsx
<SegmentedControl data={['React', 'Angular', 'Vue']} />
```

```typescript
//
```

### Slider

```typescript: test/mantine-input.tsx
<Slider
  color="blue"
  marks={[
    { value: 20, label: '20%' },
    { value: 50, label: '50%' },
    { value: 80, label: '80%' },
  ]}
/>
```

```typescript
//
```

### Switch

```typescript: test/mantine-input.tsx
<Switch
  defaultChecked
  label="I agree to sell my privacy"
/>
```

```typescript
//
```

### Textarea

```typescript: test/mantine-input.tsx
<Textarea
  label="Textarea Input label"
  description="Input description"
  placeholder="Input placeholder"
/>
```

```typescript
//
```

### TextInput

```typescript: test/mantine-input.tsx
<TextInput
  label="TextInput label"
  description="Input description"
  placeholder="Input placeholder"
/>
```

```typescript
//
```

### a

```typescript: test/mantine-input.tsx
</>
```

```typescript
//
```

## `Buttons`
## `Navigation`
## `Feedback`
## `Overlays`
## `DataDisplay`
## `Typography`

# おわりに

# 参考文献

https://zenn.dev/tnyo43/articles/39e4caa321d0aa

https://zenn.dev/takky94/articles/4daa73dd516bf3

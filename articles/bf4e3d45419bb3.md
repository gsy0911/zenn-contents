---
title: "ã€å‚™å¿˜éŒ²ã€‘ã‚µãƒãƒ¼ãƒˆçµ‚äº†ã—ãŸCetnOS6.7ã®Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã®ä½œæˆ"
emoji: "ğŸª"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics: ["CentOS6"]
published: false
---

# ã¯ã˜ã‚ã«

:::message alert
æœ¬è¨˜äº‹ã§ã¯ã‚µãƒãƒ¼ãƒˆãŒçµ‚äº†ã—ãŸCentOS6ç³»ã®Dokcerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã—ã‚ˆã†ã¨ã—ã¾ã™ã€‚
æœ¬å½“ã«å¿…è¦ãªå ´åˆã‚’é™¤ã„ã¦åˆ©ç”¨ã—ãªã„ã‚ˆã†ã«ã—ã¦ãã ã•ã„ã€‚
:::

CentOS6ç³»ã¯ã‚µãƒãƒ¼ãƒˆãŒ2020å¹´11æœˆã«çµ‚ã‚ã‚Šã¾ã—ãŸã€‚ãŸã ã€CentOS6ç³»ã§å‹•ã‹ã—ã¦ã„ã‚‹ã‚µãƒ¼ãƒ“ã‚¹ãªã©ã‚’ã€Dockerã«ç§»ã—ãŸã„è¦æœ›ãŒã‚ã‚‹éš›ã«ã¯ã“ã®ã‚ˆã†ãªæ–¹æ³•ã‚’å–ã‚‹ã—ã‹ãªã„å ´åˆã‚‚ã‚ã‚Šã¾ã™ã€‚

æœ¬è¨˜äº‹ã§ã¯ä»¥ä¸‹ã®2ã¤ã®è¨˜äº‹ã‚’å‚è€ƒã«ãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹Dockerã‚¤ãƒ¡ãƒ¼ã‚¸ã‚’ä½œæˆã—ã¾ã™ã€‚

https://blog.odaryo.com/2020/12/docker-settings-for-centos6-and-php5-6/

https://teratail.com/questions/538ut77715pp8j

# Dockerfileã¨å‹•ä½œç¢ºèª

ãƒ™ãƒ¼ã‚¹ã¨ãªã‚‹Dockerfileã¯ä»¥ä¸‹ã®é€šã‚Šã§ã™ã€‚

```Dockerfile
FROM centos:centos6.7

RUN sed -i "s|#baseurl=|baseurl=|g" /etc/yum.repos.d/CentOS-Base.repo \
  && sed -i "s|mirrorlist=|#mirrorlist=|g" /etc/yum.repos.d/CentOS-Base.repo \
  && sed -i "s|http://mirror\.centos\.org/centos/\$releasever|http://ftp\.riken\.jp/Linux/centos-vault/6.7|g" /etc/yum.repos.d/CentOS-Base.repo

RUN yum -y install httpd
RUN echo "hello, world!" > /var/www/html/index.html
CMD ["/usr/sbin/httpd", "-D", "FOREGROUND"]
```

## å¤‰æ›´ç‚¹

1ã¤ç›®ã®è¨˜äº‹ã§ã€yumãƒªãƒã‚¸ãƒˆãƒªã®æ›¸ãæ›ãˆã‚’ã—ã¦ã„ã‚‹ã®ã§ã™ãŒã€

> yumãƒªãƒã‚¸ãƒˆãƒªãŒã‚¢ãƒ¼ã‚«ã‚¤ãƒ–ã•ã‚Œã¦ã„ã‚‹ã®ã§ã€å‚ç…§å…ˆã‚’æ›¸ãæ›ãˆã¾ã™ã€‚

2ã¤ç›®ã®è¨˜äº‹ã®ã€ä»¥ä¸‹ã®è¦å› ãŒé‡ãªã£ã¦ã—ã¾ã£ãŸã“ã¨ã«ã‚ˆã£ã¦ã€ãƒªãƒã‚¸ãƒˆãƒªã‚’æ›¸ãæ›ãˆã¦ã‚‚ã†ã¾ãã„ã‹ãªã„ã‚ˆã†ã«ãªã£ã¦ã—ã¾ã£ã¦ã„ã¾ã™ã€‚

> http://vault.centos.org/ ã¯ https://vault.centos.org/ ã«ãƒªãƒ€ã‚¤ãƒ¬ã‚¯ãƒˆã•ã‚Œã¾ã™ãŒã€TLS v1.2 ä»¥ä¸Šã˜ã‚ƒãªã„ã¨æ¥ç¶šã§ããªã„ã‚ˆã†ã§ã™ã€‚
CentOS 6 ã® openssl ã¯ TLS v1.2 ã«å¯¾å¿œã—ã¦ã„ãªã„ã®ã§ã€ã‚¨ãƒ©ãƒ¼ã«ãªã‚Šã¾ã™ã€‚


ãã®ãŸã‚ã€å…ƒè¨˜äº‹ã®æ›¸ãæ›ãˆå†…å®¹ã‚’ä»¥ä¸‹ã®ã‚ˆã†ã«æ›¸ãæ›ãˆã¦ã„ã¾ã™ã€‚

```diff Dockerfile
RUN sed -i "s|#baseurl=|baseurl=|g" /etc/yum.repos.d/CentOS-Base.repo \
  && sed -i "s|mirrorlist=|#mirrorlist=|g" /etc/yum.repos.d/CentOS-Base.repo \
-  && sed -i "s|http://mirror\.centos\.org/centos/\$releasever|http://vault\.centos\.org/centos/6.9|g" /etc/yum.repos.d/CentOS-Base.repo
+  && sed -i "s|http://mirror\.centos\.org/centos/\$releasever|http://ftp\.riken\.jp/Linux/centos-vault/6.7|g" /etc/yum.repos.d/CentOS-Base.repo
```

## èµ·å‹•

ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã§ãƒ“ãƒ«ãƒ‰ã¨å®Ÿè¡Œã‚’ã—ã¾ã™ã€‚

```shell
$ docker buildx build --platform linux/x86_64 -t centos6.7:latest -f ./Dockerfile .
$ docker run --rm -d -p 80:80 centos6.7
```

ãã—ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã—ã¦ã€`hello, world!`ãŒè¡¨ç¤ºã•ã‚Œã‚Œã°OKã§ã™ã€‚

# ãŠã‚ã‚Šã«

ã‚ã¾ã‚Šä½¿ã‚ã‚Œãªã„ã“ã¨ã‚’æœ›ã¿ã¾ã™ãŒã€ãã‚Œã§ã‚‚èª°ã‹ã®å‚è€ƒã«ãªã‚Œã°å¬‰ã—ã„ã§ã™ã€‚

# å‚è€ƒ

- [ã‚µãƒãƒ¼ãƒˆå®Œå…¨çµ‚äº†ã®CentOS6ã¨PHP5.6ã®é–‹ç™ºç’°å¢ƒã‚’Dockerã§ä½œæˆã™ã‚‹](https://blog.odaryo.com/2020/12/docker-settings-for-centos6-and-php5-6/)
- [Centos6.7 ã§ yum ã‚’ã™ã‚‹ã¨[Errno 14] problem making ssl connectionã¨ãªã‚‹](https://teratail.com/questions/538ut77715pp8j)
- [EC2å†…ã§Dockerã‚³ãƒ³ãƒ†ãƒŠã‚’èµ·å‹•ã—ã¦ã€ãƒ–ãƒ©ã‚¦ã‚¶ã‹ã‚‰ã‚¢ã‚¯ã‚»ã‚¹ã™ã‚‹](https://weseek.co.jp/tech/2196/)
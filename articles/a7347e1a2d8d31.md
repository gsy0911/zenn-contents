---
title: "WezTermのタブにアイコンをつける"
emoji: "🍬"
type: "tech" # tech: 技術記事 / idea: アイデア
topics: ["wezterm"]
published: false
---


# はじめに

以前、以下の記事でWezTermを触り始めて、大まかな見た目などを変更したりタブにディレクトリ名を入れたりしました。

https://zenn.dev/gsy0911/articles/73747712233191

基本的に上記の設定で困ることはないのですが、もう少しわかりやすくしたいという気がしてきます。

設定後の完成イメージは次の通りです。以下がWezTermの画面になっており、下部にタブを表示しています。


![](/images/wezterm_tab_icon/wezterm_tab_icon_01.png =600x)
*iconが設定されたWezTermの画面*

タブの部分のみ拡大したのが以下の図です。これから説明していきます。

![](/images/wezterm_tab_icon/wezterm_tab_icon_02.png =600x)
*WezTermのタブの拡大図*

# 設定

WezTemで設定できるiconは以下の公式サイトにまとめられています。この中から上記のアイコンを設定していきます。

https://wezfurlong.org/wezterm/config/lua/wezterm/nerdfonts.html



`local wezterm = require 'wezterm'`を記述した上で、以下のように決めました。`node`の場合のみ、`TypeScript`のアイコンを設定しているのは、変な気もしますが実際にこのプロセスが動くのはReactなどのサーバーを動かすことが多いためこのようにしています。

| 項目 | nerdfontsの名前 |
|:---:|:---:|
| neovim | wezterm.nerdfonts.linux_neovim |
| docker |  wezterm.nerdfonts.md_docker|
| node | wezterm.nerdfonts.md_language_typescript |
| python | wezterm.nerdfonts.dev_python |
| task | wezterm.nerdfonts.cod_server_process |
| zsh | wezterm.nerdfonts.dev_terminal |
| fallback | wezterm.nerdfonts.md_console_network |

上記のようなiconの対応関係を持って、weztermの設定をしていきます。


まずは、アイコンを定数として定義します。

```lua: ~/Library/Application Support/lazygit/wezterm.lua
  （前略）
-- タブのアイコン
local TAB_ICON_DOCKER = wezterm.nerdfonts.md_docker
local TAB_ICON_PYTHON = wezterm.nerdfonts.dev_python
local TAB_ICON_NEOVIM = wezterm.nerdfonts.linux_neovim
local TAB_ICON_ZSH = wezterm.nerdfonts.dev_terminal
local TAB_ICON_TASK = wezterm.nerdfonts.cod_server_process
local TAB_ICON_NODE = wezterm.nerdfonts.md_language_typescript
local TAB_ICON_FALLBACK = wezterm.nerdfonts.md_console_network
-- タブの左側の装飾
local SOLID_LEFT_ARROW = wezterm.nerdfonts.ple_lower_right_triangle
local SOLID_LEFT_CIRCLE = wezterm.nerdfonts.ple_left_half_circle_thick
-- タブの右側の装飾
local SOLID_RIGHT_ARROW = wezterm.nerdfonts.ple_upper_left_triangle
local SOLID_RIGHT_CIRCLE = wezterm.nerdfonts.ple_right_half_circle_thick
```

次に、タブの色の設定です。

```lua: ~/Library/Application Support/lazygit/wezterm.lua
  （承前）
wezterm.on("format-tab-title", function(tab, tabs, panes, config, hover, max_width)
  local background = "#5c6d74"
  local foreground = "#FFFFFF"
  local edge_background = "none"
  if tab.is_active then
    background = "#ae8b2d"
    foreground = "#FFFFFF"
  end
  local edge_foreground = background
  local pane = tab.active_pane
  local pane_id = pane.pane_id

  local cwd = "none"
  if title_cache[pane_id] then
    cwd = title_cache[pane_id]
  else
    cwd = "-"
  end
  
```

上記と合わせて、プロセスの名前に対応するアイコンの名前を設定します。

```lua: ~/Library/Application Support/lazygit/wezterm.lua
  （承前）
  local icon = TAB_ICON_FALLBACK
  local icon_foreground = "#ae8b2d"
  if tab.active_pane.title == "nvim" then
    icon = TAB_ICON_NEOVIM
    icon_foreground = "#32cd32"
  elseif tab.active_pane.title == "zsh" then
    icon = TAB_ICON_ZSH
    icon_foreground = "#808080"
  elseif tab.active_pane.title == "Python" or string.find(tab.active_pane.title, "python") then
    icon = TAB_ICON_PYTHON
    icon_foreground = "#ffd700"
  elseif tab.active_pane.title == "node" or string.find(tab.active_pane.title, "node") then
    icon = TAB_ICON_NODE
    icon_foreground = "#1e90ff"
  elseif tab.active_pane.title == "docker" or string.find(tab.active_pane.title, "docker") then
    icon = TAB_ICON_DOCKER
    icon_foreground = "#4169e1"
  elseif tab.active_pane.title == "task" or string.find(tab.active_pane.title, "task") then
    icon = TAB_ICON_TASK
    icon_foreground = "#ff7f50"
  end
```

最後に、タブの名前を順次作成していきます。

```lua: ~/Library/Application Support/lazygit/wezterm.lua
  （承前）
  local wholeTitle = cwd 
  local title = " " .. wezterm.truncate_right(wholeTitle, max_width - 1) .. " "
  return {
    { Background = { Color = edge_background } },
    { Foreground = { Color = icon_foreground } },
    { Text = icon },
    { Text = " " },
    { Foreground = { Color = edge_foreground } },
    { Text = SOLID_LEFT_CIRCLE },
    { Background = { Color = background } },
    { Foreground = { Color = foreground } },
    { Text = title },
    { Background = { Color = edge_background } },
    { Foreground = { Color = edge_foreground } },
    { Text = SOLID_RIGHT_CIRCLE },
  }
end)
```

以下に全てをまとめたファイルを置いておきます。実際に反映する場合には利用してください。

::::details まとめたwezterm.lua


```lua: ~/Library/Application Support/lazygit/wezterm.lua
-- タブのアイコン
local TAB_ICON_DOCKER = wezterm.nerdfonts.md_docker
local TAB_ICON_PYTHON = wezterm.nerdfonts.dev_python
local TAB_ICON_NEOVIM = wezterm.nerdfonts.linux_neovim
local TAB_ICON_ZSH = wezterm.nerdfonts.dev_terminal
local TAB_ICON_TASK = wezterm.nerdfonts.cod_server_process
local TAB_ICON_NODE = wezterm.nerdfonts.md_language_typescript
local TAB_ICON_FALLBACK = wezterm.nerdfonts.md_console_network
-- タブの左側の装飾
local SOLID_LEFT_ARROW = wezterm.nerdfonts.ple_lower_right_triangle
local SOLID_LEFT_CIRCLE = wezterm.nerdfonts.ple_left_half_circle_thick
-- タブの右側の装飾
local SOLID_RIGHT_ARROW = wezterm.nerdfonts.ple_upper_left_triangle
local SOLID_RIGHT_CIRCLE = wezterm.nerdfonts.ple_right_half_circle_thick

wezterm.on("format-tab-title", function(tab, tabs, panes, config, hover, max_width)
  local background = "#5c6d74"
  local foreground = "#FFFFFF"
  local edge_background = "none"
  if tab.is_active then
    background = "#ae8b2d"
    foreground = "#FFFFFF"
  end
  local edge_foreground = background
  local pane = tab.active_pane
  local pane_id = pane.pane_id

  local cwd = "none"
  if title_cache[pane_id] then
    cwd = title_cache[pane_id]
  else
    cwd = "-"
  end
  
  local icon = TAB_ICON_FALLBACK
  local icon_foreground = "#ae8b2d"
  if tab.active_pane.title == "nvim" then
    icon = TAB_ICON_NEOVIM
    icon_foreground = "#32cd32"
  elseif tab.active_pane.title == "zsh" then
    icon = TAB_ICON_ZSH
    icon_foreground = "#808080"
  elseif tab.active_pane.title == "Python" or string.find(tab.active_pane.title, "python") then
    icon = TAB_ICON_PYTHON
    icon_foreground = "#ffd700"
  elseif tab.active_pane.title == "node" or string.find(tab.active_pane.title, "node") then
    icon = TAB_ICON_NODE
    icon_foreground = "#1e90ff"
  elseif tab.active_pane.title == "docker" or string.find(tab.active_pane.title, "docker") then
    icon = TAB_ICON_DOCKER
    icon_foreground = "#4169e1"
  elseif tab.active_pane.title == "task" or string.find(tab.active_pane.title, "task") then
    icon = TAB_ICON_TASK
    icon_foreground = "#ff7f50"
  end

  local wholeTitle = cwd 
  local title = " " .. wezterm.truncate_right(wholeTitle, max_width - 1) .. " "
  return {
    { Background = { Color = edge_background } },
    { Foreground = { Color = icon_foreground } },
    { Text = icon },
    { Text = " " },
    { Foreground = { Color = edge_foreground } },
    { Text = SOLID_LEFT_CIRCLE },
    { Background = { Color = background } },
    { Foreground = { Color = foreground } },
    { Text = title },
    { Background = { Color = edge_background } },
    { Foreground = { Color = edge_foreground } },
    { Text = SOLID_RIGHT_CIRCLE },
  }
end)
```
::::

# おわりに

